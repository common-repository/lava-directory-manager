!function(t,o){var e,n=0;function i(t,e){return t!==o?t:"gmap3_"+(e?n+1:++n)}function s(o,e,n,i,s){if(e.todo.events||e.todo.onces){var a={id:i,data:e.todo.data,tag:e.todo.tag};e.todo.events&&t.each(e.todo.events,function(e,i){var r=o,l=i;t.isArray(i)&&(r=i[0],l=i[1]),google.maps.event.addListener(n,e,function(t){l.apply(r,[s||n,t,a])})}),e.todo.onces&&t.each(e.todo.onces,function(e,i){var r=o,l=i;t.isArray(i)&&(r=i[0],l=i[1]),google.maps.event.addListenerOnce(n,e,function(t){l.apply(r,[s||n,t,a])})})}}function a(){var t=[];this.empty=function(){return!t.length},this.add=function(o){t.push(o)},this.get=function(){return!!t.length&&t[0]},this.ack=function(){t.shift()}}function r(o,n,i){var s,a={},r=this,l={latLng:{map:!1,marker:!1,infowindow:!1,circle:!1,overlay:!1,getlatlng:!1,getmaxzoom:!1,getelevation:!1,streetviewpanorama:!1,getaddress:!0},geoloc:{getgeoloc:!0}};function u(){var t;for(t in i)if(!(t in a))return t}"string"==typeof i&&(i=function(t){var o={};return o[t]={},o}(i)),this.run=function(){for(var r,p;r=u();){if("function"==typeof o[r])return s=r,p=t.extend(!0,{},e[r]||{},i[r].options||{}),void(r in l.latLng?i[r].values?I(i[r].values,o,o[r],{todo:i[r],opts:p,session:a}):k(o,o[r],l.latLng[r],{todo:i[r],opts:p,session:a}):r in l.geoloc?B(o,o[r],{todo:i[r],opts:p,session:a}):o[r].apply(o,[{todo:i[r],opts:p,session:a}]));a[r]=null}n.apply(o,[i,a])},this.ack=function(t){a[s]=t,r.run.apply(r,[])}}function l(t){var o,e=[];for(o in t)e.push(o);return e}function u(o,e){var n={};if(o.todo)for(var i in o.todo)"options"!==i&&"values"!==i&&(n[i]=o.todo[i]);var s,a=["data","tag","id","events","onces"];for(s=0;s<a.length;s++)p(n,a[s],e,o.todo);return n.options=t.extend({},o.opts||{},e.options||{}),n}function p(t,o){for(var e=2;e<arguments.length;e++)if(o in arguments[e])return void(t[o]=arguments[e][o])}function c(o,n,i,s){var a=this,r=[];e.classes.OverlayView.call(this),this.setMap(o),this.onAdd=function(){var o=this.getPanes();n.pane in o&&t(o[n.pane]).append(s),t.each("dblclick click mouseover mousemove mouseout mouseup mousedown".split(" "),function(o,e){r.push(google.maps.event.addDomListener(s[0],e,function(o){t.Event(o).stopPropagation(),google.maps.event.trigger(a,e,[o]),a.draw()}))}),r.push(google.maps.event.addDomListener(s[0],"contextmenu",function(o){t.Event(o).stopPropagation(),google.maps.event.trigger(a,"rightclick",[o]),a.draw()}))},this.getPosition=function(){return i},this.setPosition=function(t){i=t,this.draw()},this.draw=function(){var t=this.getProjection().fromLatLngToDivPixel(i);s.css("left",t.x+n.offset.x+"px").css("top",t.y+n.offset.y+"px")},this.onRemove=function(){for(var t=0;t<r.length;t++)google.maps.event.removeListener(r[t]);s.remove()},this.hide=function(){s.hide()},this.show=function(){s.show()},this.toggle=function(){s&&(s.is(":visible")?this.show():this.hide())},this.toggleDOM=function(){this.getMap()?this.setMap(null):this.setMap(o)},this.getDOMElement=function(){return s[0]}}function d(o,n,a){var r,l,u,p,c=!1,d=!1,g=!1,f=!1,h=!0,v=this,m=[],y={},w={},L={},M=[],x=[],k=[],I=function(t,o){function n(){return this.onAdd=function(){},this.onRemove=function(){},this.draw=function(){},e.classes.OverlayView.apply(this,[])}n.prototype=e.classes.OverlayView.prototype;var i=new n;return i.setMap(t),i}(n,a.radius);function B(t){M[t]||(delete x[t].options.map,M[t]=new e.classes.Marker(x[t].options),s(o,{todo:x[t]},M[t],x[t].id))}function P(t){"object"==typeof y[t]?("function"==typeof y[t].obj.setMap&&y[t].obj.setMap(null),"function"==typeof y[t].obj.remove&&y[t].obj.remove(),"function"==typeof y[t].shadow.remove&&y[t].obj.remove(),"function"==typeof y[t].shadow.setMap&&y[t].shadow.setMap(null),delete y[t].obj,delete y[t].shadow):M[t]&&M[t].setMap(null),delete y[t]}function S(){var t=function(){var t,o,e,n,i,s,a,r;return arguments[0]instanceof google.maps.LatLng?(t=arguments[0].lat(),e=arguments[0].lng(),arguments[1]instanceof google.maps.LatLng?(o=arguments[1].lat(),n=arguments[1].lng()):(o=arguments[1],n=arguments[2])):(t=arguments[0],e=arguments[1],arguments[2]instanceof google.maps.LatLng?(o=arguments[2].lat(),n=arguments[2].lng()):(o=arguments[2],n=arguments[3])),i=Math.PI*t/180,s=Math.PI*e/180,a=Math.PI*o/180,r=Math.PI*n/180,6371e3*Math.acos(Math.min(Math.cos(i)*Math.cos(a)*Math.cos(s)*Math.cos(r)+Math.cos(i)*Math.sin(s)*Math.cos(a)*Math.sin(r)+Math.sin(i)*Math.sin(a),1))}(n.getCenter(),n.getBounds().getNorthEast());return new google.maps.Circle({center:n.getCenter(),radius:1.25*t}).getBounds()}function j(){clearTimeout(r),r=setTimeout(function(){O()},25)}function O(){if(!c&&!g&&f){var o,e,i,s,r,v,m,w,L,b,M,I,B,j,O,C=[],T={},E=n.getZoom(),A="maxZoom"in a&&E>a.maxZoom,_=function(){var t,o={};for(t in y)o[t]=!0;return o}(),D=!1;for(d=!1,E>3&&(D=(r=S()).getSouthWest().lng()<r.getNorthEast().lng()),o=0;o<x.length;o++)!x[o]||D&&!r.contains(x[o].options.position)||u&&!u(k[o])||C.push(o);for(;;){for(o=0;T[o]&&o<C.length;)o++;if(o==C.length)break;if(s=[],h&&!A){M=10;do{for(w=s,s=[],M--,m=w.length?r.getCenter():x[C[o]].options.position,I=m,B=void 0,j=void 0,O=void 0,B=l.fromLatLngToDivPixel(I),j=l.fromDivPixelToLatLng(new google.maps.Point(B.x+a.radius,B.y-a.radius)),O=l.fromDivPixelToLatLng(new google.maps.Point(B.x-a.radius,B.y+a.radius)),r=new google.maps.LatLngBounds(O,j),e=o;e<C.length;e++)T[e]||r.contains(x[C[e]].options.position)&&s.push(e)}while(w.length<s.length&&s.length>1&&M)}else for(e=o;e<C.length;e++)if(!T[e]){s.push(e);break}for(v={indexes:[],ref:[]},L=b=0,i=0;i<s.length;i++)T[s[i]]=!0,v.indexes.push(C[s[i]]),v.ref.push(C[s[i]]),L+=x[C[s[i]]].options.position.lat(),b+=x[C[s[i]]].options.position.lng();L/=s.length,b/=s.length,v.latLng=new google.maps.LatLng(L,b),v.ref=v.ref.join("-"),v.ref in _?delete _[v.ref]:(1===s.length&&(y[v.ref]=!0),p(v))}t.each(_,function(t){P(t)}),g=!1}}!function t(){l=I.getProjection();if(!l)return void setTimeout(function(){t.apply(v,[])},25);f=!0;m.push(google.maps.event.addListener(n,"zoom_changed",function(){j()}));m.push(google.maps.event.addListener(n,"bounds_changed",function(){j()}));O()}(),this.getById=function(t){return t in w&&(B(w[t]),M[w[t]])},this.rm=function(t){var o=w[t];M[o]&&M[o].setMap(null),delete M[o],M[o]=!1,delete x[o],x[o]=!1,delete k[o],k[o]=!1,delete w[t],delete L[o],d=!0},this.clearById=function(t){if(t in w)return this.rm(t),!0},this.clear=function(t,o,e){var n,i,s,a,r,l=[],u=b(e);for(t?(n=x.length-1,i=-1,s=-1):(n=0,i=x.length,s=1),a=n;a!=i&&(!x[a]||u&&!u(x[a].tag)||(l.push(L[a]),!o&&!t));a+=s);for(r=0;r<l.length;r++)this.rm(l[r])},this.add=function(t,o){t.id=i(t.id),this.clearById(t.id),w[t.id]=M.length,L[M.length]=t.id,M.push(null),x.push(t),k.push(o),d=!0},this.addMarker=function(t,e){(e=e||{}).id=i(e.id),this.clearById(e.id),e.options||(e.options={}),e.options.position=t.getPosition(),s(o,{todo:e},t,e.id),w[e.id]=M.length,L[M.length]=e.id,M.push(t),x.push(e),k.push(e.data||{}),d=!0},this.todo=function(t){return x[t]},this.value=function(t){return k[t]},this.marker=function(t){return t in M&&(B(t),M[t])},this.markerIsSet=function(t){return Boolean(M[t])},this.setMarker=function(t,o){M[t]=o},this.store=function(t,o,e){y[t.ref]={obj:o,shadow:e}},this.free=function(){for(var o=0;o<m.length;o++)google.maps.event.removeListener(m[o]);m=[],t.each(y,function(t){P(t)}),y={},t.each(x,function(t){x[t]=null}),x=[],t.each(M,function(t){M[t]&&(M[t].setMap(null),delete M[t])}),M=[],t.each(k,function(t){delete k[t]}),k=[],w={},L={}},this.filter=function(t){u=t,O()},this.enable=function(t){h!=t&&(h=t,O())},this.display=function(t){p=t},this.error=function(t){t},this.beginUpdate=function(){c=!0},this.endUpdate=function(){c=!1,d&&O()},this.autofit=function(t){for(var o=0;o<x.length;o++)x[o]&&t.extend(x[o].options.position)}}function g(t,o){this.id=function(){return t},this.filter=function(t){o.filter(t)},this.enable=function(){o.enable(!0)},this.disable=function(){o.enable(!1)},this.add=function(t,e,n){n||o.beginUpdate(),o.addMarker(t,e),n||o.endUpdate()},this.getById=function(t){return o.getById(t)},this.clearById=function(t,e){var n;return e||o.beginUpdate(),n=o.clearById(t),e||o.endUpdate(),n},this.clear=function(t,e,n,i){i||o.beginUpdate(),o.clear(t,e,n),i||o.endUpdate()}}function f(){var e={},n={};function s(t){return{id:t.id,name:t.name,object:t.obj,tag:t.tag,data:t.data}}function a(t){"function"==typeof t.setMap&&t.setMap(null),"function"==typeof t.remove&&t.remove(),"function"==typeof t.free&&t.free(),t=null}this.add=function(t,o,s,a){var r=t.todo||{},l=i(r.id);return e[o]||(e[o]=[]),l in n&&this.clearById(l),n[l]={obj:s,sub:a,name:o,id:l,tag:r.tag,data:r.data},e[o].push(l),l},this.getById=function(t,o,e){return t in n&&(o?n[t].sub:e?s(n[t]):n[t].obj)},this.get=function(t,o,i,a){var r,l,u=b(i);if(!e[t]||!e[t].length)return null;for(r=e[t].length;r;)if(r--,(l=e[t][o?r:e[t].length-r-1])&&n[l]){if(u&&!u(n[l].tag))continue;return a?s(n[l]):n[l].obj}return null},this.all=function(t,i,a){var r=[],l=b(i),u=function(t){var o,i;for(o=0;o<e[t].length;o++)if((i=e[t][o])&&n[i]){if(l&&!l(n[i].tag))continue;r.push(a?s(n[i]):n[i].obj)}};if(t in e)u(t);else if(t===o)for(t in e)u(t);return r},this.rm=function(t,o,i){var s,a;if(!e[t])return!1;if(o)if(i)for(s=e[t].length-1;s>=0&&(a=e[t][s],!o(n[a].tag));s--);else for(s=0;s<e[t].length&&(a=e[t][s],!o(n[a].tag));s++);else s=i?e[t].length-1:0;return s in e[t]&&this.clearById(e[t][s],s)},this.clearById=function(t,i){if(t in n){var s,r=n[t].name;for(s=0;i===o&&s<e[r].length;s++)t===e[r][s]&&(i=s);return a(n[t].obj),n[t].sub&&a(n[t].sub),delete n[t],e[r].splice(i,1),!0}return!1},this.objGetById=function(t){var o;if(e.clusterer)for(var i in e.clusterer)if(!1!==(o=n[e.clusterer[i]].obj.getById(t)))return o;return!1},this.objClearById=function(t){if(e.clusterer)for(var o in e.clusterer)if(n[e.clusterer[o]].obj.clearById(t))return!0;return null},this.clear=function(t,o,n,i){var s,a,r,l=b(i);if(t&&t.length)t=L(t);else for(s in t=[],e)t.push(s);for(a=0;a<t.length;a++)if(r=t[a],o)this.rm(r,l,!0);else if(n)this.rm(r,l,!1);else for(;this.rm(r,l,!1););},this.objClear=function(o,i,s,a){if(e.clusterer&&(t.inArray("marker",o)>=0||!o.length))for(var r in e.clusterer)n[e.clusterer[r]].obj.clear(i,s,a)}}var h={},v=new function(){var t=[];this.get=function(o){if(t.length){var e,n,i,s,a,r=l(o);for(e=0;e<t.length;e++){for(s=t[e],a=r.length==s.keys.length,n=0;n<r.length&&a;n++)(a=(i=r[n])in s.request)&&(a="object"==typeof o[i]&&"equals"in o[i]&&"function"==typeof o[i]?o[i].equals(s.request[i]):o[i]===s.request[i]);if(a)return s.results}}},this.store=function(o,e){t.push({request:o,keys:l(o),results:e})}};function m(){return h.elevationService||(h.elevationService=new google.maps.ElevationService),h.elevationService}function y(){if(e.verbose){var t,o=[];if(window.console&&"function"==typeof console.error){for(t=0;t<arguments.length;t++)o.push(arguments[t]);console.error.apply(console,o)}else{for(o="",t=0;t<arguments.length;t++)o+=arguments[t].toString()+" ";alert(o)}}}function w(t){return("number"==typeof t||"string"==typeof t)&&""!==t&&!isNaN(t)}function L(t){var e,n=[];if(t!==o)if("object"==typeof t)if("number"==typeof t.length)n=t;else for(e in t)n.push(t[e]);else n.push(t);return n}function b(e){if(e)return"function"==typeof e?e:(e=L(e),function(n){if(n===o)return!1;if("object"==typeof n){for(var i=0;i<n.length;i++)if(t.inArray(n[i],e)>=0)return!0;return!1}return t.inArray(n,e)>=0})}function M(o,e,n){var i=e?o:null;return o&&"string"!=typeof o?o.latLng?M(o.latLng):o instanceof google.maps.LatLng?o:w(o.lat)?new google.maps.LatLng(o.lat,o.lng):!n&&t.isArray(o)&&w(o[0])&&w(o[1])?new google.maps.LatLng(o[0],o[1]):i:i}function x(o){var e,n;return!o||o instanceof google.maps.LatLngBounds?o||null:(t.isArray(o)?2==o.length?(e=M(o[0]),n=M(o[1])):4==o.length&&(e=M([o[0],o[1]]),n=M([o[2],o[3]])):"ne"in o&&"sw"in o?(e=M(o.ne),n=M(o.sw)):"n"in o&&"e"in o&&"s"in o&&"w"in o&&(e=M([o.n,o.e]),n=M([o.s,o.w])),e&&n?new google.maps.LatLngBounds(n,e):null)}function k(t,o,n,i,s){var a=!!n&&M(i.todo,!1,!0),r=a?{latLng:a}:!!i.todo.address&&("string"==typeof i.todo.address?{address:i.todo.address}:i.todo.address),l=!!r&&v.get(r),u=this;r?(s=s||0,l?(i.latLng=l.results[0].geometry.location,i.results=l.results,i.status=l.status,o.apply(t,[i])):(r.location&&(r.location=M(r.location)),r.bounds&&(r.bounds=x(r.bounds)),(h.geocoder||(h.geocoder=new google.maps.Geocoder),h.geocoder).geocode(r,function(a,l){l===google.maps.GeocoderStatus.OK?(v.store(r,{results:a,status:l}),i.latLng=a[0].geometry.location,i.results=a,i.status=l,o.apply(t,[i])):l===google.maps.GeocoderStatus.OVER_QUERY_LIMIT&&s<e.queryLimit.attempt?setTimeout(function(){k.apply(u,[t,o,n,i,s+1])},e.queryLimit.delay+Math.floor(Math.random()*e.queryLimit.random)):(y("geocode failed",l,r),i.latLng=i.results=!1,i.status=l,o.apply(t,[i]))}))):(i.latLng=M(i.todo,!1,!0),o.apply(t,[i]))}function I(o,e,n,i){var s=this,a=-1;!function r(){do{a++}while(a<o.length&&!("address"in o[a]));a>=o.length?n.apply(e,[i]):k(s,function(e){delete e.todo,t.extend(o[a],e),r.apply(s,[])},!0,{todo:o[a]})}()}function B(t,o,e){var n=!1;navigator&&navigator.geolocation?navigator.geolocation.getCurrentPosition(function(i){n||(n=!0,e.latLng=new google.maps.LatLng(i.coords.latitude,i.coords.longitude),o.apply(t,[e]))},function(){n||(n=!0,e.latLng=!1,o.apply(t,[e]))},e.opts.getCurrentPosition):(e.latLng=!1,o.apply(t,[e]))}function P(n){var l,p=this,v=new a,w=new f,b=null;function k(){!l&&(l=v.get())&&l.run()}function I(){l=null,v.ack(),k.call(p)}function B(o){if(o.todo.callback){var e=Array.prototype.slice.call(arguments,1);"function"==typeof o.todo.callback?o.todo.callback.apply(n,e):t.isArray(o.todo.callback)&&"function"==typeof o.todo.callback[1]&&o.todo.callback[1].apply(o.todo.callback[0],e)}}function P(t,o,e){e&&s(n,t,o,e),B(t,o),l.ack(o)}function S(o,i){if(i=i||{},b)i.todo&&i.todo.options&&(i.todo.options.center&&(i.todo.options.center=M(i.todo.options.center)),b.setOptions(i.todo.options));else{var s=i.opts||t.extend(!0,{},e.map,i.todo&&i.todo.options?i.todo.options:{});s.center=o||M(s.center),b=new e.classes.Map(n.get(0),s)}}function j(o,e,i){var a=[],r="values"in o.todo;r||(o.todo.values=[{options:o.opts}]),o.todo.values.length?(S(),t.each(o.todo.values,function(r,l){var p,c,d,g,f=u(o,l);if(f.options[i])if(f.options[i][0][0]&&t.isArray(f.options[i][0][0]))for(c=0;c<f.options[i].length;c++)for(d=0;d<f.options[i][c].length;d++)f.options[i][c][d]=M(f.options[i][c][d]);else for(c=0;c<f.options[i].length;c++)f.options[i][c]=M(f.options[i][c]);f.options.map=b,g=new google.maps[e](f.options),a.push(g),p=w.add({todo:f},e.toLowerCase(),g),s(n,{todo:f},g,p)}),P(o,r?a:a[0])):P(o,!1)}this._plan=function(t){for(var o=0;o<t.length;o++)v.add(new r(p,I,t[o]));k()},this.map=function(t){S(t.latLng,t),s(n,t,b),P(t,b)},this.destroy=function(t){w.clear(),n.empty(),b&&(b=null),P(t,!0)},this.infowindow=function(i){var a=[],r="values"in i.todo;r||(i.latLng&&(i.opts.position=i.latLng),i.todo.values=[{options:i.opts}]),t.each(i.todo.values,function(t,l){var p,c,d=u(i,l);d.options.position=d.options.position?M(d.options.position):M(l.latLng),b||S(d.options.position),(c=new e.classes.InfoWindow(d.options))&&(d.open===o||d.open)&&(r?c.open(b,d.anchor?d.anchor:o):c.open(b,d.anchor?d.anchor:i.latLng?o:i.session.marker?i.session.marker:o)),a.push(c),p=w.add({todo:d},"infowindow",c),s(n,{todo:d},c,p)}),P(i,r?a:a[0])},this.circle=function(o){var i=[],a="values"in o.todo;a||(o.opts.center=o.latLng||M(o.opts.center),o.todo.values=[{options:o.opts}]),o.todo.values.length?(t.each(o.todo.values,function(t,a){var r,l,p=u(o,a);p.options.center=p.options.center?M(p.options.center):M(a),b||S(p.options.center),p.options.map=b,l=new e.classes.Circle(p.options),i.push(l),r=w.add({todo:p},"circle",l),s(n,{todo:p},l,r)}),P(o,a?i:i[0])):P(o,!1)},this.overlay=function(o,i){var a=[],r="values"in o.todo;if(r||(o.todo.values=[{latLng:o.latLng,options:o.opts}]),o.todo.values.length){if(c.__initialised||(c.prototype=new e.classes.OverlayView,c.__initialised=!0),t.each(o.todo.values,function(e,r){var l,p,d=u(o,r),g=t(document.createElement("div")).css({border:"none",borderWidth:"0px",position:"absolute"});g.append(d.options.content),p=new c(b,d.options,M(d)||M(r),g),a.push(p),g=null,i||(l=w.add(o,"overlay",p),s(n,{todo:d},p,l))}),i)return a[0];P(o,r?a:a[0])}else P(o,!1)},this.getaddress=function(t){B(t,t.results,t.status),l.ack()},this.getlatlng=function(t){B(t,t.results,t.status),l.ack()},this.getmaxzoom=function(t){(h.maxZoomService||(h.maxZoomService=new google.maps.MaxZoomService),h.maxZoomService).getMaxZoomAtLatLng(t.latLng,function(o){B(t,o.status===google.maps.MaxZoomStatus.OK&&o.zoom,status),l.ack()})},this.getelevation=function(t){var o,e=[],n=function(o,e){B(t,e===google.maps.ElevationStatus.OK&&o,e),l.ack()};if(t.latLng)e.push(t.latLng);else for(e=L(t.todo.locations||[]),o=0;o<e.length;o++)e[o]=M(e[o]);if(e.length)m().getElevationForLocations({locations:e},n);else{if(t.todo.path&&t.todo.path.length)for(o=0;o<t.todo.path.length;o++)e.push(M(t.todo.path[o]));e.length?m().getElevationAlongPath({path:e,samples:t.todo.samples},n):l.ack()}},this.defaults=function(o){t.each(o.todo,function(o,n){"object"==typeof e[o]?e[o]=t.extend({},e[o],n):e[o]=n}),l.ack(!0)},this.rectangle=function(o){var i=[],a="values"in o.todo;a||(o.todo.values=[{options:o.opts}]),o.todo.values.length?(t.each(o.todo.values,function(t,a){var r,l,p=u(o,a);p.options.bounds=p.options.bounds?x(p.options.bounds):x(a),b||S(p.options.bounds.getCenter()),p.options.map=b,l=new e.classes.Rectangle(p.options),i.push(l),r=w.add({todo:p},"rectangle",l),s(n,{todo:p},l,r)}),P(o,a?i:i[0])):P(o,!1)},this.polyline=function(t){j(t,"Polyline","path")},this.polygon=function(t){j(t,"Polygon","paths")},this.trafficlayer=function(t){S();var o=w.get("trafficlayer");o||((o=new e.classes.TrafficLayer).setMap(b),w.add(t,"trafficlayer",o)),P(t,o)},this.bicyclinglayer=function(t){S();var o=w.get("bicyclinglayer");o||((o=new e.classes.BicyclingLayer).setMap(b),w.add(t,"bicyclinglayer",o)),P(t,o)},this.groundoverlay=function(t){t.opts.bounds=x(t.opts.bounds),t.opts.bounds&&S(t.opts.bounds.getCenter());var o=new e.classes.GroundOverlay(t.opts.url,t.opts.bounds,t.opts.opts);o.setMap(b),P(t,o,w.add(t,"groundoverlay",o))},this.streetviewpanorama=function(o){o.opts.opts||(o.opts.opts={}),o.latLng?o.opts.opts.position=o.latLng:o.opts.opts.position&&(o.opts.opts.position=M(o.opts.opts.position)),o.todo.divId?o.opts.container=document.getElementById(o.todo.divId):o.opts.container&&(o.opts.container=t(o.opts.container).get(0));var n=new e.classes.StreetViewPanorama(o.opts.container,o.opts.opts);n&&b.setStreetView(n),P(o,n,w.add(o,"streetviewpanorama",n))},this.kmllayer=function(o){var i=[],a="values"in o.todo;a||(o.todo.values=[{options:o.opts}]),o.todo.values.length?(t.each(o.todo.values,function(t,a){var r,l,p,c=u(o,a);b||S(),p=c.options,c.options.opts&&(p=c.options.opts,c.options.url&&(p.url=c.options.url)),p.map=b,l=function(t){var o,e=google.maps.version.split(".");for(t=t.split("."),o=0;o<e.length;o++)e[o]=parseInt(e[o],10);for(o=0;o<t.length;o++){if(t[o]=parseInt(t[o],10),!e.hasOwnProperty(o))return!1;if(e[o]<t[o])return!1}return!0}("3.10")?new e.classes.KmlLayer(p):new e.classes.KmlLayer(p.url,p),i.push(l),r=w.add({todo:c},"kmllayer",l),s(n,{todo:c},l,r)}),P(o,a?i:i[0])):P(o,!1)},this.panel=function(e){S();var i,s=0,a=0,r=t(document.createElement("div"));r.css({position:"absolute",zIndex:1e3,visibility:"hidden"}),e.opts.content&&(i=t(e.opts.content),r.append(i),n.first().prepend(r),e.opts.left!==o?s=e.opts.left:e.opts.right!==o?s=n.width()-i.width()-e.opts.right:e.opts.center&&(s=(n.width()-i.width())/2),e.opts.top!==o?a=e.opts.top:e.opts.bottom!==o?a=n.height()-i.height()-e.opts.bottom:e.opts.middle&&(a=(n.height()-i.height())/2),r.css({top:a,left:s,visibility:"visible"})),P(e,r,w.add(e,"panel",r)),r=null},this.marker=function(a){var r="values"in a.todo,l=!b;if(r||(a.opts.position=a.latLng||M(a.opts.position),a.todo.values=[{options:a.opts}]),a.todo.values.length)if(l&&S(),!a.todo.cluster||b.getBounds())if(a.todo.cluster){var c,f;a.todo.cluster instanceof g?(c=a.todo.cluster,f=w.getById(c.id(),!0)):(f=function(e){var i,a,r=new d(n,b,e),l={},u={},c=[],g=/^[0-9]+$/;for(a in e)g.test(a)?(c.push(1*a),u[a]=e[a],u[a].width=u[a].width||0,u[a].height=u[a].height||0):l[a]=e[a];return c.sort(function(t,o){return t>o}),i=l.calculator?function(o){var e=[];return t.each(o,function(t,o){e.push(r.value(o))}),l.calculator.apply(n,[e])}:function(t){return t.length},r.error(function(){y.apply(p,arguments)}),r.display(function(a){var d,g,f,h,v,m=i(a.indexes);if(e.force||m>1)for(d=0;d<c.length;d++)c[d]<=m&&(g=u[c[d]]);g?(v=g.offset||[-g.width/2,-g.height/2],(f=t.extend({},l)).options=t.extend({pane:"overlayLayer",content:g.content?g.content.replace("CLUSTER_COUNT",m):"",offset:{x:("x"in v?v.x:v[0])||0,y:("y"in v?v.y:v[1])||0}},l.options||{}),h=p.overlay({todo:f,opts:f.options,latLng:M(a)},!0),f.options.pane="floatShadow",f.options.content=t(document.createElement("div")).width(g.width+"px").height(g.height+"px").css({cursor:"pointer"}),shadow=p.overlay({todo:f,opts:f.options,latLng:M(a)},!0),l.data={latLng:M(a),markers:[]},t.each(a.indexes,function(t,o){l.data.markers.push(r.value(o)),r.markerIsSet(o)&&r.marker(o).setMap(null)}),s(n,{todo:l},shadow,o,{main:h,shadow:shadow}),r.store(a,h,shadow)):t.each(a.indexes,function(t,o){r.marker(o).setMap(b)})}),r}(a.todo.cluster),c=new g(i(a.todo.id,!0),f),w.add(a,"clusterer",c,f)),f.beginUpdate(),t.each(a.todo.values,function(t,o){var e=u(a,o);e.options.position=e.options.position?M(e.options.position):M(o),e.options.position&&(e.options.map=b,l&&(b.setCenter(e.options.position),l=!1),f.add(e,o))}),f.endUpdate(),P(a,c)}else{var h=[];t.each(a.todo.values,function(t,o){var i,r,p=u(a,o);p.options.position=p.options.position?M(p.options.position):M(o),p.options.position&&(p.options.map=b,l&&(b.setCenter(p.options.position),l=!1),r=new e.classes.Marker(p.options),h.push(r),i=w.add({todo:p},"marker",r),s(n,{todo:p},r,i))}),P(a,r?h:h[0])}else google.maps.event.addListenerOnce(b,"bounds_changed",function(){p.marker.apply(p,[a])});else P(a,!1)},this.getroute=function(t){t.opts.origin=M(t.opts.origin,!0),t.opts.destination=M(t.opts.destination,!0),(h.directionsService||(h.directionsService=new google.maps.DirectionsService),h.directionsService).route(t.opts,function(o,e){B(t,e==google.maps.DirectionsStatus.OK&&o,e),l.ack()})},this.directionsrenderer=function(o){o.opts.map=b;var e=new google.maps.DirectionsRenderer(o.opts);o.todo.divId?e.setPanel(document.getElementById(o.todo.divId)):o.todo.container&&e.setPanel(t(o.todo.container).get(0)),P(o,e,w.add(o,"directionsrenderer",e))},this.getgeoloc=function(t){P(t,t.latLng)},this.styledmaptype=function(t){S();var o=new e.classes.StyledMapType(t.todo.styles,t.opts);b.mapTypes.set(t.todo.id,o),P(t,o)},this.imagemaptype=function(t){S();var o=new e.classes.ImageMapType(t.opts);b.mapTypes.set(t.todo.id,o),P(t,o)},this.autofit=function(o){var e=new google.maps.LatLngBounds;t.each(w.all(),function(t,o){o.getPosition?e.extend(o.getPosition()):o.getBounds?(e.extend(o.getBounds().getNorthEast()),e.extend(o.getBounds().getSouthWest())):o.getPaths?o.getPaths().forEach(function(t){t.forEach(function(t){e.extend(t)})}):o.getPath?o.getPath().forEach(function(t){e.extend(t)}):o.getCenter?e.extend(o.getCenter()):o instanceof g&&(o=w.getById(o.id(),!0))&&o.autofit(e)}),e.isEmpty()||b.getBounds()&&b.getBounds().equals(e)||("maxZoom"in o.todo&&google.maps.event.addListenerOnce(b,"bounds_changed",function(){this.getZoom()>o.todo.maxZoom&&this.setZoom(o.todo.maxZoom)}),b.fitBounds(e)),P(o,!0)},this.clear=function(o){if("string"==typeof o.todo){if(w.clearById(o.todo)||w.objClearById(o.todo))return void P(o,!0);o.todo={name:o.todo}}o.todo.id?t.each(L(o.todo.id),function(t,o){w.clearById(o)||w.objClearById(o)}):(w.clear(L(o.todo.name),o.todo.last,o.todo.first,o.todo.tag),w.objClear(L(o.todo.name),o.todo.last,o.todo.first,o.todo.tag)),P(o,!0)},this.exec=function(o){var e=this;t.each(L(o.todo.func),function(i,s){t.each(e.get(o.todo,!0,!o.todo.hasOwnProperty("full")||o.todo.full),function(t,o){s.call(n,o)})}),P(o,!0)},this.get=function(e,n,i){var s,a,r=n?e:e.todo;if(n||(i=r.full),"string"==typeof r?!1===(a=w.getById(r,!1,i)||w.objGetById(r))&&(s=r,r={}):s=r.name,"map"===s&&(a=b),a||(a=[],r.id?(t.each(L(r.id),function(t,o){a.push(w.getById(o,!1,i)||w.objGetById(o))}),t.isArray(r.id)||(a=a[0])):(t.each(s?L(s):[o],function(o,e){var n;r.first?(n=w.get(e,!1,r.tag,i))&&a.push(n):r.all?t.each(w.all(e,r.tag,i),function(t,o){a.push(o)}):(n=w.get(e,!0,r.tag,i))&&a.push(n)}),r.all||t.isArray(s)||(a=a[0]))),a=t.isArray(a)||!r.all?a:[a],n)return a;P(e,a)},this.getdistance=function(t){var o;for(t.opts.origins=L(t.opts.origins),o=0;o<t.opts.origins.length;o++)t.opts.origins[o]=M(t.opts.origins[o],!0);for(t.opts.destinations=L(t.opts.destinations),o=0;o<t.opts.destinations.length;o++)t.opts.destinations[o]=M(t.opts.destinations[o],!0);(h.distanceMatrixService||(h.distanceMatrixService=new google.maps.DistanceMatrixService),h.distanceMatrixService).getDistanceMatrix(t.opts,function(o,e){B(t,e===google.maps.DistanceMatrixStatus.OK&&o,e),l.ack()})},this.trigger=function(o){if("string"==typeof o.todo)google.maps.event.trigger(b,o.todo);else{var e=[b,o.todo.eventName];o.todo.var_args&&t.each(o.todo.var_args,function(t,o){e.push(o)}),google.maps.event.trigger.apply(google.maps.event,e)}B(o),l.ack()}}t.fn.gmap3=function(){var o,n=[],i=[];for(e||(e={verbose:!1,queryLimit:{attempt:5,delay:250,random:250},classes:{Map:google.maps.Map,Marker:google.maps.Marker,InfoWindow:google.maps.InfoWindow,Circle:google.maps.Circle,Rectangle:google.maps.Rectangle,OverlayView:google.maps.OverlayView,StreetViewPanorama:google.maps.StreetViewPanorama,KmlLayer:google.maps.KmlLayer,TrafficLayer:google.maps.TrafficLayer,BicyclingLayer:google.maps.BicyclingLayer,GroundOverlay:google.maps.GroundOverlay,StyledMapType:google.maps.StyledMapType,ImageMapType:google.maps.ImageMapType},map:{mapTypeId:google.maps.MapTypeId.ROADMAP,center:[46.578498,2.457275],zoom:2},overlay:{pane:"floatPane",content:"",offset:{x:0,y:0}},geoloc:{getCurrentPosition:{maximumAge:6e4,timeout:5e3}}}),o=0;o<arguments.length;o++)arguments[o]&&n.push(arguments[o]);return n.length||n.push("map"),t.each(this,function(){var o=t(this),e=o.data("gmap3");!1,e||(e=new P(o),o.data("gmap3",e)),1!==n.length||"get"!==n[0]&&!function(t){var o;if(!t.hasOwnProperty("get"))return!1;for(o in t)if("get"!==o)return!1;return!t.get.hasOwnProperty("callback")}(n[0])?e._plan(n):"get"===n[0]?i.push(e.get("map",!0)):i.push(e.get(n[0].get,!0,n[0].get.full))}),i.length?1===i.length?i[0]:i:this}}(jQuery);